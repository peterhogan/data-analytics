from pycorenlp import StanfordCoreNLP
nlp = StanfordCoreNLP('http://172.17.0.1:9000')

articlelist =['Theresa May is going to fire David Cameron', 'Mike Smith is going to France','The US president Barack Obama has said Donald Trump is a knobber', 'Mike Jordan Smith, David Cameron and Michelle Obama went to the French capital Paris, in April']

people = []
places = []
orgs = []
misc = []

tokenlist1 = ["PERSON","LOCATION","MISC","ORGANIZATION"]

def addToList(text, ner):
    if ner == "PERSON":
        people.append(text)
    elif ner == "LOCATION":
        places.append(text)
    elif ner == "ORGANIZATION": 
        orgs.append(text)
    elif ner == "MISC":
        misc.append(text)

for article in articlelist:
    annotate_article = nlp.annotate(article, properties={'annotators': 'ner', 'outputFormat': 'json'})
    for j in range(len(annotate_article['sentences'])):
        #tokens_in_sequence = 0
        chamber=[]
        for k in range(len(annotate_article['sentences'][j]['tokens'])):

            token = annotate_article['sentences'][j]['tokens'][k]
            token_ner = token['ner']
            token_text = token['originalText']

            if token_ner in [chamber[i][1] for i in range(len(chamber))]:
                print(token_ner,'is in',[chamber[i][1] for i in range(len(chamber))])
                chamber.append((token_text,token_ner))
            else: 
                print(token_ner,'is NOT in',[chamber[i][1] for i in range(len(chamber))])
                if len(chamber) > 0:
                    print('Chamber is nonempty:', chamber)
                    addToList(' '.join([chamber[a][0] for a in range(len(chamber))]), chamber[0][1])
                    chamber = []
                else:
                    if token_ner in tokenlist1:
                        print((token_text,token_ner),'is in',tokenlist1)
                        chamber.append((token_text,token_ner))
                    else:
                        print(token_text,'is not an entity')
                        pass
                





print('People:',people)
print('Places:',places)
print('Orgs:',orgs)
print('Misc:',misc)
